---
const {
  slug = "",
  title,
  summary,
  image = "/images/projects/buildinhub-cover.png",
  tags = [],
  maxTags = 4,
} = Astro.props;

const shown = tags.slice(0, maxTags);
const extra = Math.max(0, tags.length - shown.length);
const pageHref = `/projects/${slug}`;
---
<article class="card card-eq tilt" data-tilt>
  <!-- Media: full image (no cropping) -->
  <figure class="relative aspect-[16/10] bg-white/5">
    <img
      src={image}
      alt={`${title} preview`}
      class="absolute inset-0 h-full w-full object-contain p-2"
      loading="lazy"
      decoding="async"
      sizes="(min-width:1024px) 33vw, (min-width:640px) 50vw, 100vw"
    />
    <!-- Quick view (opens modal) -->
    <button
      type="button"
      class="btn-icon absolute right-3 top-3 js-open-project"
      data-slug={slug}
      title="Quick view"
      aria-label={`Quick view ${title}`}
    >
      <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z" fill="none" stroke="currentColor" stroke-width="2"/>
        <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="2"/>
      </svg>
    </button>
  </figure>

  <!-- Body -->
  <div class="p-5 flex min-h-[12rem] flex-1 flex-col gap-4">
    <div>
      <h3 class="text-lg font-semibold">{title}</h3>
      <p class="mt-2 text-sm/6 opacity-90">{summary}</p>
    </div>

    <!-- Tags -->
    <div class="flex flex-wrap gap-2">
      {shown.map((t) => <span class="tag">{t}</span>)}
      {extra > 0 && (
        <span class="tag inline-flex items-center gap-1" aria-label={`${extra} more technologies`}>
          <svg viewBox="0 0 20 20" width="12" height="12" aria-hidden="true">
            <path d="M10 4v12M4 10h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span>{extra} more</span>
        </span>
      )}
    </div>

    <!-- Divider + CTAs pinned to bottom -->
    <div class="mt-auto border-t border-white/10 pt-4 flex items-center gap-3">
      <a href={pageHref} class="btn btn-ghost" aria-label={`Open ${title} page`}>View project â†’</a>
      <button
        type="button"
        class="btn btn-ghost js-open-project"
        data-slug={slug}
        aria-label={`Quick view ${title}`}
      >Quick view</button>
    </div>
  </div>
</article>
